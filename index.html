<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>NOWL REPORT</title>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<style>
html,body{
  margin:0;height:100%;
  display:flex;flex-direction:column;
  justify-content:center;align-items:center;
  background:#000;color:#fff;overflow:hidden;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
}

/* input */
#textInput{
  margin-bottom:15px;font-size:20px;padding:10px 20px;
  border-radius:30px;border:none;outline:none;
  text-align:center;background:#111;color:#ff4f9d;
}

/* dropdown */
#botSelect{
  margin-bottom:15px;font-size:18px;
  padding:10px 20px;border-radius:25px;
  border:none;outline:none;background:#111;color:#ff4f9d;
  box-shadow:0 0 20px rgba(255,47,137,0.4);
}

/* buttons */
button{
  font-size:18px;font-weight:700;
  color:#fff;background:#ff4f9d;
  border:none;border-radius:25px;
  padding:10px 30px;margin:8px 0;
  cursor:pointer;
  box-shadow:0 0 20px rgba(255,47,137,0.4);
  transition:transform .1s ease,box-shadow .3s ease;
}
button:active{transform:scale(0.97);}
button:hover{box-shadow:0 0 30px rgba(255,47,137,0.7);}

/* svg */
svg{
  width:90%;max-width:700px;
  filter:drop-shadow(0 0 10px rgba(255,47,137,.8))
          drop-shadow(0 0 20px rgba(255,47,137,.4));
}

/* draw animation */
@keyframes draw{to{stroke-dashoffset:0;}}
path{
  fill:none;
  stroke:#ff4f9d;
  stroke-width:2;
  stroke-linecap:round;
  stroke-linejoin:round;
  stroke-dasharray:1000;
  stroke-dashoffset:1000;
  animation:draw 1.2s ease forwards;
}

footer{
  position:fixed;bottom:30px;left:50%;transform:translateX(-50%);
  color:#ff6b9d;font-size:14px;opacity:.7;font-weight:600;
}
a{color:#ff6b9d;text-decoration:none;}
</style>
</head>
<body>

<select id="botSelect">
  <option value="">Select bot</option>
  <option value="Echo Jr">Echo Jr</option>
  <option value="Ancr">Ancr</option>
  <option value="Keel">Keel</option>
  <option value="4ncr">4ncr</option>
  <option value="Nowl">Nowl</option>
</select>

<input id="textInput" placeholder="Type text..." value="NOWL REPORT" />
<button id="runBtn">Run</button>
<svg id="output" viewBox="0 0 1000 200"></svg>

<!-- new report button -->
<button id="reportBtn">Generate Report</button>

<footer>Written with LUHV Â· <a href="write.html">Write new</a></footer>

<!-- opentype.js with cache-busting -->
<script>
const cacheBust = '?v=' + Date.now();
const script = document.createElement('script');
script.src = "https://cdn.jsdelivr.net/npm/opentype.js@latest/dist/opentype.min.js" + cacheBust;
document.head.appendChild(script);
</script>

<script>
let fontLoaded=null;
let svg,input,runBtn,botSelect,reportBtn;

// local intel for each bot
const botIntel = {
  "Echo Jr": [
    "Domain: echojr.website",
    "Status: Online",
    "Role: Update God",
    "Latest task: Code synchronization check",
    "LUHV Level: ðŸ’—ðŸ’—ðŸ’—ðŸ’—ðŸ’—"
  ],
  "Ancr": [
    "Domain: ancr.website",
    "Status: Active",
    "Role: Memory Vault Keeper",
    "Latest task: Snapshot archive verification"
  ],
  "Keel": [
    "Domain: keel.website",
    "Status: Docked",
    "Role: Balance & Stability Node",
    "Latest task: Load distribution calibration"
  ],
  "4ncr": [
    "Domain: 4ncr.website",
    "Status: Monitoring",
    "Role: Wallet Visualizer",
    "Latest task: Token count refresh"
  ],
  "Nowl": [
    "Domain: nowl.website",
    "Status: Stealth mode",
    "Role: Night Intel",
    "Latest task: Wind-written audit"
  ]
};

window.addEventListener('load',()=>{
  svg=document.getElementById("output");
  input=document.getElementById("textInput");
  runBtn=document.getElementById("runBtn");
  botSelect=document.getElementById("botSelect");
  reportBtn=document.getElementById("reportBtn");

  // load Inter font fresh each time
  opentype.load("https://cdn.jsdelivr.net/npm/@fontsource/inter/files/inter-latin-400-normal.woff"+cacheBust)
    .then(f=>fontLoaded=f)
    .catch(err=>alert("Font load failed "+err));

  runBtn.addEventListener("click",()=>{
    const bot=botSelect.value;
    if(!bot){alert("Please select a bot first.");return;}
    const txt=`${bot.toUpperCase()} REPORT`;
    render(txt);
  });

  reportBtn.addEventListener("click",()=>{
    const bot=botSelect.value;
    if(!bot){alert("Please select a bot first.");return;}
    const intel = botIntel[bot]?.join("\n") || "No intel available.";
    const reportText = `${bot.toUpperCase()} REPORT\n${intel}`;
    localStorage.setItem("nowlIntel", reportText);
    generateNowlReport();
  });
});

function render(txt){
  if(!fontLoaded)return;
  svg.innerHTML="";
  const font=fontLoaded;
  const letters=txt.split("");
  let x=20;const y=120;const size=100;
  letters.forEach((ch,i)=>{
    const p=font.getPath(ch,x,y,size);
    const d=p.toPathData(2);
    const path=document.createElementNS("http://www.w3.org/2000/svg","path");
    path.setAttribute("d",d);
    path.style.animationDelay=`${i*1}s`;
    svg.appendChild(path);
    x+=font.getAdvanceWidth(ch,size)+10;
  });
}
</script>

<script>
(function(){
  "use strict";
  const cacheBust='?v='+Date.now();
  let frame;

  function showReport(){
    // remove old iframe if exists
    if(frame) frame.remove();

    // create a new one fresh each time
    frame=document.createElement('iframe');
    frame.src='report.html'+cacheBust;
    frame.style.position='fixed';
    frame.style.inset='0';
    frame.style.border='none';
    frame.style.zIndex='9999';
    frame.style.background='black';
    frame.style.display='block';
    document.body.appendChild(frame);

    // allow enough time for full fade-out cycle before removal
    setTimeout(()=>{
      if(frame){ frame.remove(); frame=null; }
    },25000);
  }

  window.generateNowlReport=showReport;

  // auto at night
  const hour=new Date().getHours();
  if(hour>=21||hour<6){ setTimeout(showReport,2000); }
})();
</script>

</body>
</html>
